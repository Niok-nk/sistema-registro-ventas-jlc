---
interface Props {
  buttonId?: string;
  menuId?: string;
  countId?: string;
  disabled?: boolean;
}

const {
  buttonId = "export-btn",
  menuId = "export-menu",
  countId = "export-count",
  disabled = false,
} = Astro.props;
---

<div class="export-controls">
  <button id={buttonId} class="btn-export" disabled={disabled}>
    <svg viewBox="0 0 20 20" fill="currentColor">
      <path
        fill-rule="evenodd"
        d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
        clip-rule="evenodd"></path>
    </svg>
    Exportar (<span id={countId}>0</span>)
  </button>

  <!-- Dropdown menu -->
  <div id={menuId} class="export-menu">
    <button data-format="excel">
      <svg viewBox="0 0 20 20" fill="currentColor">
        <path
          d="M9 2a2 2 0 00-2 2v8a2 2 0 002 2h6a2 2 0 002-2V6.414A2 2 0 0016.414 5L14 2.586A2 2 0 0012.586 2H9z"
        ></path>
        <path d="M3 8a2 2 0 012-2v10h8a2 2 0 01-2 2H5a2 2 0 01-2-2V8z"></path>
      </svg>
      Excel (.xlsx)
    </button>
    <button data-format="csv">
      <svg viewBox="0 0 20 20" fill="currentColor">
        <path
          fill-rule="evenodd"
          d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"
          clip-rule="evenodd"></path>
      </svg>
      CSV (.csv)
    </button>
  </div>
</div>

<style>
  .export-controls {
    position: relative;
    display: inline-block;
  }

  .btn-export {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--color-accent);
    color: var(--color-accent-text);
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    transition: all 0.2s;
  }

  .btn-export:hover:not(:disabled) {
    background: var(--color-accent-hover);
  }

  .btn-export:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .btn-export svg {
    width: 1.25rem;
    height: 1.25rem;
  }

  .export-menu {
    position: absolute;
    top: calc(100% + 0.5rem);
    left: 0;
    background: var(--color-bg-main);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-md);
    min-width: 180px;
    display: none;
    z-index: 100;
  }

  .export-menu.show {
    display: block;
  }

  .export-menu button {
    width: 100%;
    padding: 0.75rem 1rem;
    background: none;
    border: none;
    color: var(--color-text-main);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    transition: background 0.2s;
    font-size: 0.9rem;
  }

  .export-menu button:hover {
    background: var(--color-accent);
    color: var(--color-accent-text);
  }

  .export-menu button svg {
    width: 1.25rem;
    height: 1.25rem;
  }
</style>
